{% extends "layout.jinja2" %}

{% block content %}


    <div class="content">
        <h1><span class="font-semi-bold">Pupil List</span> - {{ classes_dict[class_filter|int] }}</h1>

    </div>
    <div class="dropdown show">
        <a class="btn btn-secondary dropdown-toggle" href="#" role="button" id="dropdownMenuLink" data-toggle="dropdown"
           aria-haspopup="true" aria-expanded="false">
            Pick a Class
        </a>

        <div class="dropdown-menu" aria-labelledby="dropdownMenuLink">
            <a class="dropdown-item" href="?class_filter=1,2">More</a>
            {% for class_entry in classes_dict %}
                {% if class_entry == class_filter|int %}
                    <a class="dropdown-item active" href="?class_filter={{ class_entry }}">{{ classes_dict[class_entry] }}</a>
                {% else %}
                    <a class="dropdown-item" href="?class_filter={{ class_entry }}">{{ classes_dict[class_entry] }}</a>
                {% endif %}
            {% endfor %}
        </div>
    </div>

    <table class="table" id="myTable">
        <thead>
        <th scope='col'><a href="?sort=last_name">Name</a></th>
        <th scope='col'>Class</th>
        {% for capability in capabilities_nice %}
            <th scope='col'><a href="?sort={{ capability }}&class_filter={{ class_filter }}">{{ capabilities_nice[capability] }}</a></th>
        {% endfor %}
        </thead>
        <tbody>
        <tr>
            <td>Filter:</td>
            <td><a class="btn btn-info" href="?filter=&class_filter={{ class_filter }}">Clear</a></td>
            {% for capability in capabilities_nice %}
                {% if filter == capability %}
                    <td><a class="btn btn-success"
                           href="?filter={{ capability }}&class_filter={{ class_filter }}">{{ capabilities_nice[capability] }}</a></td>
                {% else %}
                    <td><a class="btn btn-outline-secondary"
                           href="?filter={{ capability }}&class_filter={{ class_filter }}">{{ capabilities_nice[capability] }}</a></td>
                {% endif %}
            {% endfor %}
        </tr>
        {% for pupil in pupils %}
            <tr class="hideable">
                <td>
                    <a href="edit?id={{ pupil.id }}">{{ pupil.first_name }} {{ pupil.last_name }}</a>

                </td>
                <td> {{ pupil['class_info.class_strand'] }} {{ pupil['class_info.class_year'] }}</td>
                {% for capability in capability_list %}
                    <td>
                        {% if pupil[capability] %}
                            <img src="{{ request.static_url('gdpr_permissions:static/tick.png') }}" width="25">
                        {% else %}
                            <img src="{{ request.static_url('gdpr_permissions:static/cross.png') }}" width="25">
                        {% endif %}
                    </td>
                {% endfor %}
            </tr>
        {% endfor %}
        </tbody>
    </table>
    <input type="hidden" name="class_filter" value="{{ class_filter }}">
{% endblock content %}
